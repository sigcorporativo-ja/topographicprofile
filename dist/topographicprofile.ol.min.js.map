{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/templates/perfiltopografico.html","webpack:///./src/impl/ol/js/profilcontrol.js","webpack:///./src/facade/js/i18n/language.js","webpack:///./src/impl/ol/js/topographicprofilecontrol.js","webpack:///./src/facade/js/topographicprofilecontrol.js","webpack:///./src/facade/js/topographicprofile.js","webpack:///./src/index.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","child","parent","translations","en","es","getLang","res","M","language","getTranslation","lang","getValue","keyPath","translation","utils","isNullOrEmpty","console","warn","split","reduce","prev","current","info","Profil","opt_options","options","this","element","self","target","document","createElement","classList","add","className","trim","elementTitle","textContent","appendChild","button","setAttribute","close","e","map","removeControl","source","clear","addEventListener","div_inner","div","style","position","ratio","canvas_","width","height","styles","keys","forEach","div_to_canvas","onMove","ol","control","Control","margin_","top","left","bottom","right","ytitle","xtitle","bar_","cursor_","popup_","cellPadding","cellSpacing","clientWidth","firstTr","div_zmin","innerHTML","zmin","div_zmax","zmax","div_distance","distance","secondTr","div_altitude","altitude","div_distance2","div_time2","time","tab_","feature","setGeometry","constructor","popup","length","box_canvas","getBoundingClientRect","pos","window","pageYOffset","documentElement","clientTop","pageXOffset","clientLeft","dx","pageX","dy","pageY","display","scale_","p0","dy_","parentElement","querySelector","altitudeUnits","toFixed","distanceUnitsKM","remove","dispatchEvent","type","click","coord","contains","show","hide","toggle","b","isShown","g","Feature","getGeometry","canvas","ctx","getContext","w","h","setTransform","clearRect","test","getLayout","getCoordinates","getType","proj","projection","getMap","getView","getProjection","strokeStyle","lineWidth","beginPath","moveTo","lineTo","stroke","z","ti","p1","p2","Infinity","sphere","getDistance","transform","getTime","push","distanceUnitsM","grad","graduation","Math","ceil","floor","amplitude","max","scx","scy","font","textAlign","textBaseline","fillStyle","zunit","fillText","setLineDash","step","unit","round","txt","replace","save","rotate","PI","restore","t0","t1","dt","trunc","mn","getImage","encoderOptions","toDataURL","TopographicprofileControl","opts","serviceURL","distancePoinst_","mercator_","coordEPSG4326","projectionMap_","profil_","facadeMap_","vector_","source_","vectorProfile_","sourceProfile_","draw_","lineCoord_","pointsCoord_","dataPoints_","pt","lineString_","feature_","style_","impl","html","initOlLayers","evt","Style","Stroke","color","image","Circle","radius","fill","Fill","Vector","wrapX","layer","setZIndex","getMapImpl","addLayer","code","originPoint","destPoint","addX","addY","points","String","oriMete","destMete","angle","getAngleBetweenPoints","getDistBetweenPoints","distPoint","newPointA","cos","sin","newPointB","firstPoint","secondPoint","geom","LineString","getLength","atan2","body","cursor","deactivate","pointerEvents","activate","createIteraction","addInteraction","typeGeom","interaction","Draw","on","clearLayer","concat","findNewPoints","getDataFromGGISCore","pointsBbox","altitudes","promises","filter","elem","bbox","url","remote","Promise","all","then","responses","response","alt","text","item","parseFloat","arrayXZY","data","index","center","extent","getCenter","controlProfile","arrayXZY2","setCoordinates","dialog","error","geometry","addFeature","addControl","drawPoint","Point","setStyle","once","getState","getFeatures","removeInteraction","removeLayer","isUndefined","TopographicprofileImplControl","exception","btnData_","btnRemove_","html_","drawCtrl_","template","compileSync","string","parseToHtml","templateVars","vars","htmlText","Handlebars","compile","templateFn","stringToHtml","success","fail","template_","title","Topographicprofile","map_","controls_","position_","metadata_","api","metadata","panel_","control_","options_","Plugin","ui","Panel","addControls","addPanels","removeControls","plugin","M$plugin$Topographicprofile","Topographicprofilecontrol","M$control$Topographicprofilecontrol","M$impl$control$TopographicprofileControl"],"mappings":"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","file":"topographicprofile.ol.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 5);\n","module.exports = \"<div class=\\\"m-control m-container m-topographicprofile-container\\\">\\r\\n    <button id='m-topographicprofile-btn' class=\\\"m-topographicprofile-btn g-grafica-puntos2\\\"></button>\\r\\n</div>\";","/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/*eslint no-constant-condition: [\"error\", { \"checkLoops\": false }]*/\n\n/*import ol_ext_inherits from '../util/ext'\nimport { getDistance as ol_sphere_getDistance } from 'ol/sphere'\nimport { transform as ol_proj_transform } from 'ol/proj'\nimport ol_control_Control from 'ol/control/Control'\nimport ol_Feature from 'ol/Feature'*/\n\nimport { getValue } from '../../../facade/js/i18n/language';\n\nconst inherits = (child, parent) => {\n  child.prototype = Object.create(parent.prototype);\n  child.prototype.constructor = child;\n};\n\n/** Custom infos list\n * @api stable\n */\nconst info = {\n  \"zmin\": \"Zmin\",\n  \"zmax\": \"Zmax\",\n  \"ytitle\": \"Altitude (m)\",\n  \"xtitle\": \"Distance (km)\",\n  \"time\": \"Time\",\n  \"altitude\": \"Altitude\",\n  \"distance\": \"Distance\",\n  \"altitudeUnits\": \"m\",\n  \"distanceUnitsM\": \"m\",\n  \"distanceUnitsKM\": \"km\",\n};\n\n\n\n/*eslint-disable*/\n\n/**\n * @classdesc OpenLayers 3 Profil Control.\n *\tDraw a profil of a feature (with a 3D geometry)\n *\n * @constructor\n * @extends {ol_control_Control}\n * @fires  over, out, show\n * @param {Object=} _ol_control_ opt_options.\n *\n */\nvar Profil = function(opt_options) {\n  var options = opt_options || {};\n  this.info = options.info || info;\n  var self = this;\n\n  var element;\n  if (options.target) {\n    element = document.createElement(\"div\");\n    element.classList.add(options.className || \"ol-profil\");\n  } else {\n    element = document.createElement(\"div\");\n    element.className = ((options.className || 'ol-profil') + ' ol-unselectable ol-control ol-collapsed').trim();\n    let elementTitle = document.createElement('p');\n    elementTitle.textContent = getValue('profil.title');\n    element.appendChild(elementTitle);\n    // let cross = document.createElement('button');\n    // cross.className = 'cross';\n    // element.appendChild(cross);\n    // cross.addEventListener(\"click\", function(e) {\n\n    // })\n    const button = document.createElement('button');\n    button.setAttribute('type', 'button');\n    button.setAttribute('class', 'profile-close-button');\n    const close = (e) => {\n      opt_options.map.removeControl(this);\n      options.source.clear();\n    };\n    button.addEventListener('click', close);\n    button.addEventListener('touchstart', close);\n    elementTitle.appendChild(button);\n  }\n\n  var div_inner = document.createElement(\"div\");\n  div_inner.classList.add(\"ol-inner\");\n  element.appendChild(div_inner);\n  var div = document.createElement(\"div\");\n  div.style.position = \"relative\";\n  div_inner.appendChild(div);\n\n  var ratio = this.ratio = 2;\n  this.canvas_ = document.createElement('canvas');\n  this.canvas_.width = (options.width || 300) * ratio;\n  this.canvas_.height = (options.height || 150) * ratio;\n\n  var styles = {\n    \"msTransform\": \"scale(0.5,0.5)\",\n    \"msTransformOrigin\": \"0 0\",\n    \"webkitTransform\": \"scale(0.5,0.5)\",\n    \"webkitTransformOrigin\": \"0 0\",\n    \"mozTransform\": \"scale(0.5,0.5)\",\n    \"mozTransformOrigin\": \"0 0\",\n    \"transform\": \"scale(0.5,0.5)\",\n    \"transformOrigin\": \"0 0\"\n  };\n\n  Object.keys(styles).forEach(function(style) {\n    if (style in self.canvas_.style) {\n      self.canvas_.style[style] = styles[style];\n    }\n  });\n\n  var div_to_canvas = document.createElement(\"div\");\n  div.appendChild(div_to_canvas);\n  div_to_canvas.style.width = this.canvas_.width / ratio + \"px\";\n  div_to_canvas.style.height = this.canvas_.height / ratio + \"px\";\n  div_to_canvas.appendChild(this.canvas_);\n  div_to_canvas.addEventListener(\"click\", function(e) { self.onMove(e); });\n  div_to_canvas.addEventListener(\"mousemove\", function(e) { self.onMove(e); });\n\n  ol.control.Control.call(this, {\n    element: element,\n    target: options.target\n  });\n\n  // Offset in px\n  this.margin_ = { top: 10 * ratio, left: 40 * ratio, bottom: 30 * ratio, right: 10 * ratio };\n  if (!this.info.ytitle) this.margin_.left -= 20 * ratio;\n  if (!this.info.xtitle) this.margin_.bottom -= 20 * ratio;\n\n  // Cursor\n  this.bar_ = document.createElement(\"div\");\n  this.bar_.classList.add(\"ol-profilbar\");\n  this.bar_.style.top = (this.margin_.top / ratio) + \"px\";\n  this.bar_.style.height = (this.canvas_.height - this.margin_.top - this.margin_.bottom) / ratio + \"px\";\n  div.appendChild(this.bar_);\n\n  this.cursor_ = document.createElement(\"div\");\n  this.cursor_.classList.add(\"ol-profilcursor\");\n  div.appendChild(this.cursor_);\n\n  this.popup_ = document.createElement(\"div\");\n  this.popup_.classList.add(\"ol-profilpopup\");\n  this.cursor_.appendChild(this.popup_);\n\n  // Track information\n  var t = document.createElement(\"table\");\n  t.cellPadding = '0';\n  t.cellSpacing = '0';\n  t.style.clientWidth = this.canvas_.width / ratio + \"px\";\n  div.appendChild(t);\n\n  var firstTr = document.createElement(\"tr\");\n  firstTr.classList.add(\"track-info\");\n  t.appendChild(firstTr);\n  var div_zmin = document.createElement(\"td\");\n  div_zmin.innerHTML = (this.info.zmin || \"Zmin\") + ': <span class=\"zmin\">';\n  firstTr.appendChild(div_zmin);\n  var div_zmax = document.createElement(\"td\");\n  div_zmax.innerHTML = (this.info.zmax || \"Zmax\") + ': <span class=\"zmax\">';\n  firstTr.appendChild(div_zmax);\n  var div_distance = document.createElement(\"td\");\n  div_distance.innerHTML = (this.info.distance || \"Distance\") + ': <span class=\"dist\">';\n  firstTr.appendChild(div_distance);\n  //var div_time = document.createElement(\"td\");\n  //div_time.innerHTML = (this.info.time || \"Time\") + ': <span class=\"time\">';\n  //firstTr.appendChild(div_time);\n  var secondTr = document.createElement(\"tr\");\n  secondTr.classList.add(\"point-info\")\n  t.appendChild(secondTr);\n  var div_altitude = document.createElement(\"td\");\n  div_altitude.innerHTML = (this.info.altitude || \"Altitude\") + ': <span class=\"z\">';\n  secondTr.appendChild(div_altitude);\n  var div_distance2 = document.createElement(\"td\");\n  div_distance2.innerHTML = (\"Dist. parcial\") + ': <span class=\"dist\">';\n  secondTr.appendChild(div_distance2);\n  var div_time2 = document.createElement(\"td\");\n  div_time2.innerHTML = (this.info.time || \"Time\") + ': <span class=\"time\">';\n  secondTr.appendChild(div_time2);\n\n  // Array of data\n  this.tab_ = [];\n\n  // Show feature\n  if (options.feature) {\n    this.setGeometry(options.feature);\n  }\n};\ninherits(Profil, ol.control.Control);\n\n/** Show popup info\n * @param {string} info to display as a popup\n * @api stable\n */\nProfil.prototype.popup = function(info) {\n  this.popup_.innerHTML = info;\n}\n\n/** Mouse move over canvas\n */\nProfil.prototype.onMove = function(e) {\n  if (!this.tab_.length) return;\n  var box_canvas = this.canvas_.getBoundingClientRect();\n  var pos = {\n    top: box_canvas.top + window.pageYOffset - document.documentElement.clientTop,\n    left: box_canvas.left + window.pageXOffset - document.documentElement.clientLeft\n  };\n\n  var dx = e.pageX - pos.left;\n  var dy = e.pageY - pos.top;\n  var ratio = this.ratio;\n  if (dx > this.margin_.left / ratio && dx < (this.canvas_.width - this.margin_.right) / ratio &&\n    dy > this.margin_.top / ratio && dy < (this.canvas_.height - this.margin_.bottom) / ratio) {\n    this.bar_.style.left = dx + \"px\";\n    this.bar_.style.display = \"block\";\n    var d = (dx * ratio - this.margin_.left) / this.scale_[0];\n    var p0 = this.tab_[0];\n    for (var i = 1, p; p = this.tab_[i]; i++) {\n      if (p[0] >= d) {\n        if (d < (p[0] + p0[0]) / 2) p = p0;\n        break;\n      }\n    }\n    if (p) {\n      this.cursor_.style.left = dx + \"px\";\n      this.cursor_.style.top = (this.canvas_.height - this.margin_.bottom + p[1] * this.scale_[1] + this.dy_) / ratio + \"px\";\n      this.cursor_.style.display = \"block\";\n    } else {\n      this.cursor_.style.display = \"none\";\n    }\n    this.bar_.parentElement.classList.add(\"over\");\n    this.element.querySelector(\".point-info .z\").textContent = p[1] + this.info.altitudeUnits;\n    this.element.querySelector(\".point-info .dist\").textContent = (p[0] / 1000).toFixed(1) + this.info.distanceUnitsKM;\n    this.element.querySelector(\".point-info .time\").textContent = p[2];\n    if (dx > this.canvas_.width / ratio / 2) this.popup_.classList.add('ol-left');\n    else this.popup_.classList.remove('ol-left');\n    this.dispatchEvent({ type: 'over', click: e.type == \"click\", coord: p[3], time: p[2], distance: p[0] });\n  } else {\n    if (this.bar_.parentElement.classList.contains(\"over\")) {\n      this.bar_.style.display = 'none';\n      this.cursor_.style.display = 'none';\n      this.bar_.parentElement.classList.remove(\"over\");\n      this.dispatchEvent({ type: 'out' });\n    }\n  }\n}\n\n/** Show panel\n * @api stable\n */\nProfil.prototype.show = function() {\n  this.element.classList.remove(\"ol-collapsed\");\n  this.dispatchEvent({ type: 'show', show: true });\n}\n/** Hide panel\n * @api stable\n */\nProfil.prototype.hide = function() {\n  this.element.classList.add(\"ol-collapsed\");\n  this.dispatchEvent({ type: 'show', show: false });\n}\n/** Toggle panel\n * @api stable\n */\nProfil.prototype.toggle = function() {\n  this.element.classList.toggle(\"ol-collapsed\");\n  var b = this.element.classList.contains(\"ol-collapsed\");\n  this.dispatchEvent({ type: 'show', show: !b });\n}\n/** Is panel visible\n */\nProfil.prototype.isShown = function() {\n  return (!this.element.classList.contains(\"ol-collapsed\"));\n}\n\n/**\n * Set the geometry to draw the profil.\n * @param {ol.Feature|ol.geom} f the feature.\n * @param {Object=} options\n *\t\t- projection {ol.ProjectionLike} feature projection, default projection of the map\n *\t\t- zunit {m|km} default m\n *\t\t- unit {m|km} default km\n *\t\t- zmin {Number|undefined} default 0\n *\t\t- zmax {Number|undefined} default max Z of the feature\n *\t\t- graduation {Number|undefined} z graduation default 100\n *\t\t- amplitude {integer|undefined} amplitude of the altitude, default zmax-zmin\n * @api stable\n */\nProfil.prototype.setGeometry = function(g, options) {\n  if (!options) options = {};\n  if (g instanceof ol.Feature) g = g.getGeometry();\n  var canvas = this.canvas_;\n  var ctx = canvas.getContext('2d');\n  var w = canvas.width;\n  var h = canvas.height;\n  ctx.setTransform(1, 0, 0, 1, 0, 0);\n  ctx.clearRect(0, 0, w, h);\n\n  // No Z\n  if (!/Z/.test(g.getLayout())) return;\n  // No time\n  if (/M/.test(g.getLayout())) this.element.querySelector(\".time\").parentElement.style.display = 'block';\n  else this.element.querySelector(\".time\").parentElement.style.display = 'none';\n\n  // Coords\n  var c = g.getCoordinates();\n\n  switch (g.getType()) {\n    case \"LineString\":\n      break;\n    case \"MultiLineString\":\n      c = c[0];\n      break;\n    default:\n      return;\n  }\n\n  /*// Distance beetween 2 coords\n  var proj = options.projection || this.getMap().getView().getProjection();\n\n  function dist2d(p1, p2) {\n    const distancia = ol.sphere.getDistance(\n      ol.proj.transform(p1.map(coord => parseFloat(coord)), 'EPSG:4326', 'EPSG:4326'),\n      ol.proj.transform(p2.map(coord => parseFloat(coord)), 'EPSG:4326', 'EPSG:4326'));\n\n    return distancia;\n\n  }*/\n\n\n  // Distance beetween 2 coords\n  var proj = options.projection || this.getMap().getView().getProjection();\n\n\n  function dist2d(p1, p2) {\n    return ol.sphere.getDistance(\n      ol.proj.transform(p1, proj, 'EPSG:4326'),\n      ol.proj.transform(p2, proj, 'EPSG:4326'))\n  }\n\n  function getTime(t0, t1) {\n    if (!t0 || !t1) return \"-\"\n    var dt = (t1 - t0) / 60; // mn\n    var ti = Math.trunc(dt / 60);\n    var mn = Math.trunc(dt - ti * 60);\n    return ti + \"h\" + (mn < 10 ? \"0\" : \"\") + mn + \"mn\";\n  }\n\n  // Margin\n  ctx.setTransform(1, 0, 0, 1, this.margin_.left, h - this.margin_.bottom);\n  var ratio = this.ratio;\n\n  w -= this.margin_.right + this.margin_.left;\n  h -= this.margin_.top + this.margin_.bottom;\n  // Draw axes\n  ctx.strokeStyle = \"#000\";\n  ctx.lineWidth = 0.5 * ratio;\n  ctx.beginPath();\n  ctx.moveTo(0, 0);\n  ctx.lineTo(0, -h);\n  ctx.moveTo(0, 0);\n  ctx.lineTo(w, 0);\n  ctx.stroke();\n\n  //\n  var zmin = Infinity,\n    zmax = -Infinity;\n  var i, p, d, z, ti, t = this.tab_ = [];\n  for (i = 0, p; p = c[i]; i++) {\n    z = p[2];\n    if (z < zmin) zmin = z;\n    if (z > zmax) zmax = z;\n    if (i == 0) d = 0;\n    else d += dist2d(c[i - 1], p);\n    ti = getTime(c[0][3], p[3]);\n    t.push([d, z, ti, p]);\n  }\n\n  // Info\n  this.element.querySelector(\".track-info .zmin\").textContent = zmin.toFixed(2) + this.info.altitudeUnits;\n  this.element.querySelector(\".track-info .zmax\").textContent = zmax.toFixed(2) + this.info.altitudeUnits;\n  if (d > 1000) {\n    this.element.querySelector(\".track-info .dist\").textContent = (d / 1000).toFixed(1) + this.info.distanceUnitsKM;\n  } else {\n    this.element.querySelector(\".track-info .dist\").textContent = (d).toFixed(1) + this.info.distanceUnitsM;\n  }\n  //this.element.querySelector(\".track-info .time\").textContent = ti;\n\n  // Set graduation\n  var grad = options.graduation || 100;\n  while (true) {\n    zmax = Math.ceil(zmax / grad) * grad;\n    zmin = Math.floor(zmin / grad) * grad;\n    var nbgrad = (zmax - zmin) / grad;\n    if (h / nbgrad < 15 * ratio) {\n      grad *= 2;\n    } else break;\n  }\n\n  // Set amplitude\n  if (typeof(options.zmin) == 'number' && zmin > options.zmin) zmin = options.zmin;\n  if (typeof(options.zmax) == 'number' && zmax < options.zmax) zmax = options.zmax;\n  var amplitude = options.amplitude;\n  if (amplitude) {\n    zmax = Math.max(zmin + amplitude, zmax);\n  }\n\n  // Scales lines\n  var scx = w / d;\n  var scy = -h / (zmax - zmin);\n  var dy = this.dy_ = -zmin * scy;\n  this.scale_ = [scx, scy];\n  // Draw\n  ctx.font = (10 * ratio) + \"px arial\";\n  ctx.textAlign = \"right\";\n  ctx.textBaseline = \"middle\";\n  ctx.fillStyle = \"#000\";\n  // Scale Z\n  ctx.beginPath();\n  for (i = zmin; i <= zmax; i += grad) {\n    if (options.zunit != \"km\") ctx.fillText(i, -4 * ratio, i * scy + dy);\n    else ctx.fillText((i / 1000).toFixed(1), -4 * ratio, i * scy + dy);\n    ctx.moveTo(-2 * ratio, i * scy + dy);\n    if (i != 0) ctx.lineTo(d * scx, i * scy + dy);\n    else ctx.lineTo(0, i * scy + dy);\n  }\n  // Scale X\n  ctx.textAlign = \"center\";\n  ctx.textBaseline = \"top\";\n  ctx.setLineDash([ratio, 3 * ratio]);\n  var unit = options.unit || \"km\";\n  var step;\n  if (d > 1000) {\n    step = Math.round(d / 1000) * 100;\n    if (step > 1000) step = Math.ceil(step / 1000) * 1000;\n  } else {\n    unit = \"m\";\n    if (d > 100) step = Math.round(d / 100) * 10;\n    else if (d > 10) step = Math.round(d / 10);\n    else if (d > 1) step = Math.round(d) / 10;\n    else step = d;\n  }\n  for (i = 0; i <= d; i += step) {\n    var txt = (unit == \"m\") ? i : (i / 1000);\n    //if (i+step>d) txt += \" \"+ (options.zunits || \"km\");\n    ctx.fillText(Math.round(txt * 10) / 10, i * scx, 4 * ratio);\n    ctx.moveTo(i * scx, 2 * ratio);\n    ctx.lineTo(i * scx, 0);\n  }\n  ctx.font = (12 * ratio) + \"px arial\";\n  ctx.fillText(this.info.xtitle.replace(\"(km)\", \"(\" + unit + \")\"), w / 2, 18 * ratio);\n  ctx.save();\n  ctx.rotate(-Math.PI / 2);\n  ctx.fillText(this.info.ytitle, h / 2, -this.margin_.left);\n  ctx.restore();\n\n  ctx.stroke();\n\n  // \n  ctx.strokeStyle = \"#368\";\n  ctx.lineWidth = 3;\n  ctx.setLineDash([]);\n  ctx.beginPath();\n  for (i = 0; p = t[i]; i++) {\n    if (i == 0) ctx.moveTo(p[0] * scx, p[1] * scy + dy);\n    else ctx.lineTo(p[0] * scx, p[1] * scy + dy);\n  }\n  ctx.stroke();\n};\n\n/** Get profil image\n * @param {string|undefined} type image format or 'canvas' to get the canvas image, default image/png.\n * @param {Number|undefined} encoderOptions between 0 and 1 indicating image quality image/jpeg or image/webp, default 0.92.\n * @return {string} requested data uri\n * @api stable\n */\nProfil.prototype.getImage = function(type, encoderOptions) {\n  if (type === \"canvas\") return this.canvas_;\n  return this.canvas_.toDataURL(type, encoderOptions);\n}\n\nexport default Profil\n","import en from './en';\nimport es from './es';\n\n/**\n * Default object with es and en translate.\n *\n * @const\n * @type {object}\n */\nconst translations = {\n  en,\n  es,\n};\n\nconst getLang = () => {\n  let res = 'es';\n  if (typeof M.language.getLang === 'function') {\n    res = M.language.getLang();\n  }\n\n  return res;\n};\n\n/**\n * This function sets a new language translate.\n * @param {string} lang\n * @param {JSON} json\n * @public\n * @api\n */\nexport const addTranslation = (lang, json) => {\n  translations[lang] = json;\n};\n\n/**\n * This function gets a language translate.\n *\n * @param {string} lang\n * @return {JSON}\n * @public\n * @api\n */\nexport const getTranslation = (lang) => {\n  return translations[lang];\n};\n\n/**\n * This function gets a language value from key\n *\n * @public\n * @param {string}\n * @param {string}\n * @return {string}\n * @public\n * @api\n */\n\nexport const getValue = (keyPath, lang = getLang()) => {\n  const translation = getTranslation(lang);\n  let value = '';\n  if (M.utils.isNullOrEmpty(translation)) {\n    /* eslint-disable no-console */\n    console.warn(`The translation '${lang}' has not been defined.`);\n  } else {\n    value = keyPath.split('.').reduce((prev, current) => prev[current], translation);\n  }\n\n  return value;\n};\n","/* eslint-disable no-console */\r\n/**\r\n * @module M/impl/control/TopographicprofileControl\r\n */\r\nimport Profil from './profilcontrol';\r\nimport { getValue } from '../../../facade/js/i18n/language';\r\n\r\nconst PROFILE_URL = 'https://servicios.idee.es/wcs-inspire/mdt?request=GetCoverage&bbox=';\r\nconst PROFILE_URL_SUFFIX = '&service=WCS&version=1.0.0&coverage=Elevacion4258_500&' +\r\n  'interpolationMethod=bilinear&crs=EPSG%3A4258&format=ArcGrid&width=2&height=2';\r\n\r\nexport default class TopographicprofileControl extends M.impl.Control {\r\n\r\n  constructor(opts) {\r\n\r\n    super();\r\n    [this.distancePoinst_, this.mercator_, this.serviceURL, this.coordEPSG4326] = [opts.distance, 'EPSG:900913', opts.serviceURL, \"EPSG:4326\"];\r\n    [this.projectionMap_, this.profil_, this.facadeMap_, this.vector_, this.source_, this.vectorProfile_, this.sourceProfile_, this.draw_, this.lineCoord_, this.pointsCoord_, this.dataPoints_, this.pt] = [null, null, null, null, null, null, null, null, null, null, null, null];\r\n    [this.lineString_, this.feature_, this.style_] = [null, null, null];\r\n\r\n  }\r\n\r\n  /**\r\n   * This function adds the control to the specified map\r\n   *\r\n   * @public\r\n   * @function\r\n   * @param {M.Map} map to add the plugin\r\n   * @param {HTMLElement} html of the plugin\r\n   * @api stable\r\n   */\r\n  addTo(map, html) {\r\n    this.facadeMap_ = map;\r\n\r\n    this.initOlLayers();\r\n    // super addTo - don't delete\r\n    super.addTo(map, html);\r\n  }\r\n\r\n  // Add your own functions\r\n  initOlLayers() {\r\n    this.style_ = function(evt) {\r\n      let style;\r\n      if (evt.getGeometry().getType() == 'LineString') {\r\n        style = [new ol.style.Style({\r\n          stroke: new ol.style.Stroke({\r\n            color: '#4286f4',\r\n            width: 2\r\n          })\r\n        })];\r\n      } else {\r\n        style = [new ol.style.Style({\r\n          image: new ol.style.Circle({\r\n            radius: 6,\r\n            fill: new ol.style.Fill({\r\n              color: '#4286f4'\r\n            })\r\n          }),\r\n          stroke: new ol.style.Stroke({\r\n            color: '#4286f4',\r\n            width: 2\r\n          }),\r\n          fill: new ol.style.Fill({\r\n            color: '#4286f4'\r\n          })\r\n        })];\r\n      }\r\n      return style;\r\n    }\r\n    this.source_ = new ol.source.Vector({\r\n      wrapX: false\r\n    });\r\n    this.vector_ = new ol.layer.Vector({\r\n      source: this.source_,\r\n      style: this.style_,\r\n      name: 'capatopo'\r\n    });\r\n    this.sourceProfile_ = new ol.source.Vector();\r\n    this.vectorProfile_ = new ol.layer.Vector({\r\n      source: this.sourceProfile_,\r\n    });\r\n    this.vector_.setZIndex(1000);\r\n    this.facadeMap_.getMapImpl().addLayer(this.vector_);\r\n    this.projectionMap_ = this.facadeMap_.getProjection().code;\r\n\r\n\r\n  }\r\n\r\n  findNewPoints(originPoint, destPoint) {\r\n    //let points = new Array();\r\n    let addX, addY;\r\n    let points = new String();\r\n    let oriMete = ol.proj.transform(originPoint, this.projectionMap_, this.mercator_);\r\n    let destMete = ol.proj.transform(destPoint, this.projectionMap_, this.mercator_);\r\n    let angle = this.getAngleBetweenPoints(oriMete, destMete);\r\n    let distance = this.getDistBetweenPoints(originPoint, destPoint);\r\n    if (distance < 50) {\r\n      return;\r\n    }\r\n    let distPoint = (distance / this.distancePoinst_ > this.distancePoinst_) ? distance / this.distancePoinst_ : this.distancePoinst_;\r\n    for (let i = 0; i <= distance / distPoint; i++) {\r\n      if (angle >= 0 && angle <= 90) {\r\n        [addX, addY] = [1, 1];\r\n      } else if (angle >= 90) {\r\n        [addX, addY] = [-1, 1];\r\n      } else if (angle <= 0 && angle >= -90) {\r\n        [addX, addY] = [1, -1];\r\n      } else {\r\n        [addX, addY] = [-1, -1];\r\n      }\r\n      let newPointA = [(Math.cos(angle * Math.PI / 180) * (distPoint * i)) + oriMete[0], (Math.sin(angle * Math.PI / 180) * (distPoint * i)) + oriMete[1]];\r\n      let newPointB = [(Math.cos(angle * Math.PI / 180) * ((distPoint * i) + addX)) + oriMete[0], (Math.sin(angle * Math.PI / 180) * ((distPoint * i) + addY)) + oriMete[1]];\r\n      points += (ol.proj.transform(newPointA, this.mercator_, this.coordEPSG4326)) + \",\";\r\n      points += (ol.proj.transform(newPointB, this.mercator_, this.coordEPSG4326)) + \"|\";\r\n    }\r\n\r\n    return points;\r\n  }\r\n\r\n\r\n  getDistBetweenPoints(firstPoint, secondPoint) {\r\n    let line = new ol.geom.LineString([ol.proj.transform(firstPoint, this.projectionMap_, this.mercator_), ol.proj.transform(secondPoint, this.projectionMap_, this.mercator_)]);\r\n    return line.getLength();\r\n\r\n  }\r\n\r\n  getAngleBetweenPoints(firstPoint, secondPoint) {\r\n    let p1 = {\r\n      x: firstPoint[0],\r\n      y: firstPoint[1]\r\n    };\r\n    let p2 = {\r\n      x: secondPoint[0],\r\n      y: secondPoint[1]\r\n    };\r\n    // angle in degrees\r\n    let angleDeg = Math.atan2(p2.y - p1.y, p2.x - p1.x) * 180 / Math.PI;\r\n    return angleDeg;\r\n  }\r\n\r\n  startLoad() {\r\n    document.body.style.cursor = 'wait';\r\n    this.deactivate();\r\n    let panel = document.querySelector(\".m-topographicprofile.activated\");\r\n    panel.style.pointerEvents = \"none\";\r\n\r\n  }\r\n\r\n\r\n  endLoad() {\r\n    document.body.style.cursor = 'default';\r\n    this.activate();\r\n    let panel = document.querySelector(\".m-topographicprofile.activated\");\r\n    panel.style.pointerEvents = \"auto\";\r\n  }\r\n\r\n\r\n  activate() {\r\n    if (!this.draw_) {\r\n      this.createIteraction(\"LineString\");\r\n    }\r\n    this.facadeMap_.getMapImpl().addInteraction(this.draw_);\r\n    document.querySelector('#m-topographicprofile-btn').classList.add('activated');\r\n  }\r\n\r\n  createIteraction(typeGeom) {\r\n    this.draw_ = new ol.interaction.Draw({\r\n      source: this.source_,\r\n      type: /** @type {ol.geom.GeometryType} */ (typeGeom)\r\n    });\r\n    this.draw_.on('drawstart', function(evt) {\r\n      this.projectionMap_ = this.facadeMap_.getProjection().code;\r\n      this.clearLayer();\r\n    }.bind(this));\r\n    this.draw_.on('drawend', function(evt) {\r\n      this.lineCoord_ = evt.feature.getGeometry().getCoordinates();\r\n      // this.facadeMap_.getMapImpl().addInteraction(this.draw_);\r\n      this.pointsCoord_ = new String();\r\n      for (let i = 1; i < this.lineCoord_.length; i++) {\r\n        this.pointsCoord_ = this.pointsCoord_.concat(this.findNewPoints(this.lineCoord_[i - 1], this.lineCoord_[i]));\r\n      }\r\n      this.getDataFromGGISCore();\r\n    }.bind(this));\r\n  }\r\n\r\n  getDataFromGGISCore() {\r\n    if (!this.pointsCoord_) return;\r\n    let pointsBbox = this.pointsCoord_.split('|');\r\n    const altitudes = [];\r\n    const promises = [];\r\n    pointsBbox = pointsBbox.filter((elem) => {\r\n      return elem !== '' && elem.trim().length > 3;\r\n    });\r\n\r\n    pointsBbox.forEach((bbox) => {\r\n      const url = `${PROFILE_URL}${bbox}${PROFILE_URL_SUFFIX}`;\r\n      promises.push(M.remote.get(url));\r\n    });\r\n\r\n    Promise.all(promises).then((responses) => {\r\n      responses.forEach((response) => {\r\n        const alt = response.text.split('dy')[1].split(' ').filter((item) => {\r\n          return item !== '';\r\n        })[1];\r\n        altitudes.push(parseFloat(alt));\r\n      });\r\n\r\n      const arrayXZY = [];\r\n      altitudes.forEach((data, index) => {\r\n        const points = pointsBbox[index].split(',');\r\n        const center = ol.extent.getCenter([parseFloat(points[0]), parseFloat(points[1]),\r\n          parseFloat(points[2]), parseFloat(points[3])\r\n        ]);\r\n        arrayXZY.push([center[0], center[1], data]);\r\n      });\r\n      this.controlProfile();\r\n\r\n      const arrayXZY2 = arrayXZY.map((coord) => {\r\n        return ol.proj.transform(coord, 'EPSG:4326', this.facadeMap_.getProjection().code);\r\n      });\r\n\r\n      this.lineString_.setCoordinates(arrayXZY2);\r\n    }).catch(() => {\r\n      M.dialog.error('No se han obtenido datos');\r\n    });\r\n    // this.deactivate();\r\n  }\r\n\r\n\r\n  controlProfile() {\r\n    if (!this.profil_) {\r\n      this.lineString_ = new ol.geom.LineString([]);\r\n      this.feature_ = new ol.Feature({\r\n        geometry: this.lineString_,\r\n        name: 'Line'\r\n      });\r\n      this.sourceProfile_.addFeature(this.feature_);\r\n      this.profil_ = new Profil({\r\n        info: {\r\n          zmin: getValue('profil.zmin'),\r\n          zmax: getValue('profil.zmax'),\r\n          altitude: getValue('profil.altitude'),\r\n          distance: getValue('profil.distance'),\r\n          ytitle: getValue('profil.ytitle'),\r\n          xtitle: getValue('profil.xtitle'),\r\n          altitudeUnits: 'm',\r\n          \"distanceUnitsM\": 'm',\r\n          'distanceUnitsKM': 'km'\r\n        },\r\n        projection: this.facadeMap_.getProjection().code,\r\n        map: this.facadeMap_.getMapImpl(),\r\n        source: this.source_\r\n      });\r\n      this.facadeMap_.getMapImpl().addControl(this.profil_);\r\n      let drawPoint = function(e) {\r\n        if (!this.pt) return;\r\n        if (e.type == \"over\") { // Show point at coord\r\n          this.pt.setGeometry(new ol.geom.Point(e.coord));\r\n          this.pt.setStyle(null);\r\n        } else { // hide point\r\n          this.pt.setStyle([]);\r\n        }\r\n      }.bind(this);\r\n      this.sourceProfile_.once('change', function(e) {\r\n        if (this.sourceProfile_.getState() === 'ready') {\r\n          this.profil_.setGeometry(this.sourceProfile_.getFeatures()[0]);\r\n          this.pt = new ol.Feature(new ol.geom.Point([0, 0]));\r\n          this.pt.setStyle([]);\r\n          this.source_.addFeature(this.pt);\r\n        }\r\n      }.bind(this));\r\n\r\n      this.profil_.on([\"over\", \"out\"], function(e) {\r\n        if (e.type == \"over\") this.profil_.popup(e.coord[2] + \" m\");\r\n        drawPoint(e);\r\n      }.bind(this));\r\n\r\n    }\r\n    this.profil_.show();\r\n  }\r\n\r\n  deactivate() {\r\n    if (this.draw_) {\r\n      this.facadeMap_.getMapImpl().removeInteraction(this.draw_);\r\n      this.clearLayer();\r\n      document.querySelector('#m-topographicprofile-btn').classList.remove('activated');\r\n    }\r\n    //Aquí hay que poner que se cambie el estilo del botón\r\n  }\r\n\r\n  clearLayer() {\r\n    this.source_.clear();\r\n    if (this.profil_) {\r\n      this.profil_.hide();\r\n      this.sourceProfile_.clear();\r\n      this.facadeMap_.getMapImpl().removeControl(this.profil_);\r\n      this.profil_ = null;\r\n    }\r\n  }\r\n\r\n  removeLayer() {\r\n    this.deactivate();\r\n    this.clearLayer();\r\n    this.facadeMap_.getMapImpl().removeLayer(this.vector_);\r\n  }\r\n\r\n  destroy() {\r\n    this.removeLayer();\r\n    this.facadeMap_.getMapImpl().removeControl(this);\r\n  }\r\n\r\n  toggle() {\r\n    if (this.profil_) {\r\n      this.profil_.toggle();\r\n    }\r\n  }\r\n\r\n\r\n}\r\n","/**\r\n * @module M/control/Topographicprofilecontrol\r\n */\r\n\r\nimport TopographicprofileImplControl from 'impl/topographicprofilecontrol';\r\nimport template from 'templates/perfiltopografico';\r\nimport { getValue } from './i18n/language';\r\n\r\nexport default class TopographicprofileControl extends M.Control {\r\n  /**\r\n   * @classdesc\r\n   * Main constructor of the class. Creates a PluginControl\r\n   * control\r\n   *\r\n   * @constructor\r\n   * @extends {M.Control}\r\n   * @api stable\r\n   */\r\n  constructor(opts) {\r\n\r\n    // 1. checks if the implementation can create PluginControl\r\n    if (M.utils.isUndefined(TopographicprofileImplControl)) {\r\n      M.exception('La implementación usada no puede crear controles TopographicprofileControl');\r\n    }\r\n    // 2. implementation of this control\r\n    const impl = new TopographicprofileImplControl(opts);\r\n    super(impl, 'Topographicprofile');\r\n\r\n    [this.btnData_, this.btnRemove_, this.facadeMap_, this.html_, this.drawCtrl_, this.opts] = [null, null, null, null, null, impl, opts];\r\n  }\r\n\r\n  /**\r\n   * This function creates the view\r\n   *\r\n   * @public\r\n   * @function\r\n   * @param {M.Map} map to add the control\r\n   * @api stable\r\n   */\r\n  createView(map) {\r\n    if (!M.template.compileSync) { // JGL: retrocompatibilidad Mapea4\r\n      M.template.compileSync = (string, options) => {\r\n        let templateCompiled;\r\n        let templateVars = {};\r\n        let parseToHtml;\r\n        if (!M.utils.isUndefined(options)) {\r\n          templateVars = M.utils.extends(templateVars, options.vars);\r\n          parseToHtml = options.parseToHtml;\r\n        }\r\n        const templateFn = Handlebars.compile(string);\r\n        const htmlText = templateFn(templateVars);\r\n        if (parseToHtml !== false) {\r\n          templateCompiled = M.utils.stringToHtml(htmlText);\r\n        } else {\r\n          templateCompiled = htmlText;\r\n        }\r\n        return templateCompiled;\r\n      };\r\n    }\r\n    this.facadeMap_ = map;\r\n\r\n    return new Promise((success, fail) => {\r\n      const html = M.template.compileSync(template);\r\n      // Añadir código dependiente del DOM\r\n      this.template_ = html;\r\n      html.querySelector('#m-topographicprofile-btn').title = getValue('title');\r\n      success(html);\r\n    });\r\n  }\r\n  /**\r\n   * This function gets activation button\r\n   *\r\n   * @public\r\n   * @function\r\n   * @param {HTML} html of control\r\n   * @api stable\r\n   */\r\n\r\n  getActivationButton(html) {\r\n    return html.querySelector('#m-topographicprofile-btn');\r\n  }\r\n\r\n\r\n  /**\r\n   * This function is called on the control deactivation\r\n   *\r\n   * @public\r\n   * @function\r\n   * @api stable\r\n   */\r\n  deactivate() {\r\n    super.deactivate();\r\n  }\r\n\r\n  /**\r\n   * This function compares controls\r\n   *\r\n   * @public\r\n   * @function\r\n   * @param {M.Control} control to compare\r\n   * @api stable\r\n   */\r\n  equals(control) {\r\n    return control instanceof TopographicprofileControl;\r\n  }\r\n}\r\n","/**\r\n * @module M/plugin/Topographicprofile\r\n */\r\nimport 'assets/css/topographicprofile';\r\nimport TopographicprofileControl from './topographicprofilecontrol';\r\nimport api from '../../api';\r\nimport { getValue } from './i18n/language';\r\n\r\nexport default class Topographicprofile extends M.Plugin {\r\n  /**\r\n   * @classdesc\r\n   * Main facade plugin object. This class creates a plugin\r\n   * object which has an implementation Object\r\n   *\r\n   * @constructor\r\n   * @extends {M.Plugin}\r\n   * @param {Object} impl implementation object\r\n   * @api stable\r\n   */\r\n  constructor(opts = {}) {\r\n    super();\r\n    /**\r\n     * Facade of the map\r\n     * @private\r\n     * @type {M.Map}\r\n     */\r\n    this.map_ = null;\r\n\r\n    /**\r\n     * Array of controls\r\n     * @private\r\n     * @type {Array<M.Control>}\r\n     */\r\n    this.controls_ = [];\r\n\r\n    /**\r\n     * Position\r\n     * @private\r\n     * @type {Array<M.Control>}\r\n     */\r\n    this.position_ = opts.position ? opts.position : 'TR';\r\n\r\n\r\n    /**\r\n     * Metadata from api.json\r\n     * @private\r\n     * @type {Object}\r\n     */\r\n    this.metadata_ = api.metadata;\r\n\r\n\r\n\r\n    this.facadeMap_ = null;\r\n    this.panel_ = null;\r\n    this.control_ = null;\r\n    this.options_ = opts;\r\n    this.options_.distance = opts.distance || 30;\r\n    // this.options_.serviceURL = opts.serviceURL || ((M.config.GGIS_RESTAPI) ? M.config.GGIS_RESTAPI + \"/services/elevation\" : \"http://ggiscloud.guadaltel.com/ggiscloud/restapi/services/elevation\");\r\n    //'http://idecan5.grafcan.es/ServicioWPS/mdt';\r\n  }\r\n\r\n  /**\r\n   * This function adds this plugin into the map\r\n   *\r\n   * @public\r\n   * @function\r\n   * @param {M.Map} map the map to add the plugin\r\n   * @api stable\r\n   */\r\n  addTo(map) {\r\n    this.controls_.push(new TopographicprofileControl(this.options_));\r\n    this.map_ = map;\r\n    // panel para agregar control - no obligatorio\r\n    this.panel_ = new M.ui.Panel('panelTopographicprofile', {\r\n      // 'collapsible': true,\r\n      'className': 'm-topographicprofile',\r\n      'collapsedButtonClass': 'g-grafica-puntos2',\r\n      'position': M.ui.position[this.position_],\r\n      'tooltip': getValue('tooltip')\r\n    });\r\n    this.panel_.addControls(this.controls_);\r\n    map.addPanels(this.panel_);\r\n  }\r\n\r\n\r\n  /**\r\n   * This function gets metadata plugin\r\n   *\r\n   * @public\r\n   * @function\r\n   * @api stable\r\n   */\r\n  getMetadata() {\r\n    return this.metadata_;\r\n  }\r\n\r\n  /**\r\n   * Get the API REST Parameters of the plugin\r\n   *\r\n   * @function\r\n   * @public\r\n   * @api\r\n   */\r\n  getAPIRest() {\r\n    return `${this.name}=${this.position_}`\r\n  }\r\n\r\n  /**\r\n   * This function destroys this plugin\r\n   *\r\n   * @public\r\n   * @function\r\n   * @api stable\r\n   */\r\n  destroy() {\r\n    this.map_.removeControls(this.controls_);\r\n    [this.map_, this.controls_, this.panel_] = [null, null, null];\r\n  }\r\n\r\n  get name() {\r\n    return \"topographicprofile\";\r\n  }\r\n}\r\n","import M$plugin$Topographicprofile from '/home/irenevinas/m5/mapea-publico/src/plugins/v5/topographicprofile/src/facade/js/topographicprofile';\nimport M$control$Topographicprofilecontrol from '/home/irenevinas/m5/mapea-publico/src/plugins/v5/topographicprofile/src/facade/js/topographicprofilecontrol';\nimport M$impl$control$TopographicprofileControl from '/home/irenevinas/m5/mapea-publico/src/plugins/v5/topographicprofile/src/impl/ol/js/topographicprofilecontrol';\n\nif (!window.M.plugin) window.M.plugin = {};\nif (!window.M.control) window.M.control = {};\nif (!window.M.impl) window.M.impl = {};\nif (!window.M.impl.control) window.M.impl.control = {};\nwindow.M.plugin.Topographicprofile = M$plugin$Topographicprofile;\nwindow.M.control.Topographicprofilecontrol = M$control$Topographicprofilecontrol;\nwindow.M.impl.control.TopographicprofileControl = M$impl$control$TopographicprofileControl;\n"],"sourceRoot":""}